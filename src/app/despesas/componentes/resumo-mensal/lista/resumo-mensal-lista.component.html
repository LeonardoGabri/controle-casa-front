<div class="list-container">
  <div class="list-header">
    <h2 class="list-title">{{ nomePagina }}</h2>
    <div class="header-actions">
      <label for="referenciaCobranca">Resumo do mês de : </label>
      <p-inputMask
        id="referenciaCobranca"
        mask="99/9999"
        placeholder="MM/AAAA"
        [(ngModel)]="filtroBuscaAvancada.referenciaCobranca"
      ></p-inputMask>
      <button
        pButton
        icon="pi pi-search"
        class="advanced-search-button"
        (click)="filtrarResumo()"
        type="button"
        style="margin-left: 8px;"
      ></button>
    </div>
  </div>

  <div class="form-group">

  </div>

  <div
    class="empty-state"
    *ngIf="itensResumoMensal?.length === 0"
  >
    <i class="pi pi-inbox"></i>
    <h3>Nenhum dado encontrado</h3>
    <p>
      Não há lançamentos para o mês selecionado.
    </p>
  </div>

  <div class="fechamento-container">
    <p-card
      *ngFor="let item of itensResumoMensal"
      class="fechamento-card"
      (click)="toggleDetalhe(item)"
    >
      <div class="fechamento-content">
        <div class="pessoa devedor">
          <i class="pi pi-user"></i>
          <strong>{{ item.devedorNome }}</strong>
          <span>deve pagar</span>
        </div>

        <div class="seta">
          <i class="pi pi-arrow-right"></i>
          <span>{{ item.valor | currency:'BRL' }}</span>
        </div>

        <div class="pessoa credor">
          <i class="pi pi-user"></i>
          <strong>{{ item.credorNome }}</strong>
          <span>vai receber</span>
        </div>
      </div>

      <div
        class="detalhe-parcelas"
        *ngIf="uiState[getKey(item)]?.expandido"
        (click)="$event.stopPropagation()"
      >
        <p-table
          [value]="uiState[getKey(item)]?.parcelas || []"
          [loading]="uiState[getKey(item)]?.carregando"
          styleClass="p-datatable-sm"
        >
          <ng-template pTemplate="header">
            <tr>
              <th>Fornecedor</th>
              <th style="text-align: right;">Valor</th>
            </tr>
          </ng-template>

          <ng-template pTemplate="body" let-parcela>
            <tr>
              <td>{{ parcela.fornecedorNome || parcela.fornecedor }}</td>
              <td style="text-align: right;">
                {{ parcela.valor | currency:'BRL' }}
              </td>
            </tr>
          </ng-template>

          <ng-template pTemplate="emptymessage">
            <tr>
              <td colspan="2" style="text-align: center;">
                Nenhuma parcela encontrada
              </td>
            </tr>
          </ng-template>
        </p-table>
      </div>
    </p-card>
  </div>


</div>
